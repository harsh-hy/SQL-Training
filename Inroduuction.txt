Document1
Introduction
This document shows the most commonly used options of the SQL Server SELECT statement. You will first create a simple Customerâ€“Order database, then practice each SELECT option using the same tables. Each section includes one example query you can run directly




SELECT *
FROM dbo.Orders
ORDER BY OrderDate DESC
OFFSET 0 ROWS FETCH NEXT 3 ROWS ONLY;



SELECT Status, COUNT(*) AS TotalOrders, SUM(Amount) AS TotalAmount
FROM dbo.Orders
GROUP BY Status;



SELECT CustomerId, SUM(Amount) AS TotalSpent
FROM dbo.Orders
GROUP BY CustomerId
HAVING SUM(Amount) > 2000;

SELECT c.FullName, o.OrderId, o.Amount, o.Status
FROM dbo.Customers c
INNER JOIN dbo.Orders o ON c.CustomerId = o.CustomerId;


SELECT c.FullName, o.OrderId, o.Status
FROM dbo.Customers c
LEFT JOIN dbo.Orders o ON c.CustomerId = o.CustomerId;

SELECT *
FROM dbo.Customers
WHERE CustomerId IN (
    SELECT CustomerId
    FROM dbo.Orders
    WHERE Status = 'Delivered'
);



SELECT OrderId, Amount,
       CASE 
           WHEN Amount >= 3000 THEN 'High'
           WHEN Amount >= 1000 THEN 'Medium'
           ELSE 'Low'
       END AS OrderSize
FROM dbo.Orders;





SELECT c.CustomerId, c.FullName
FROM dbo.Customers c
WHERE EXISTS (
    SELECT 1
    FROM dbo.Orders o
    WHERE o.CustomerId = c.CustomerId
      AND o.Status = 'Pending'
);



SELECT City FROM dbo.Customers WHERE City = 'Kanpur'
UNION
SELECT City FROM dbo.Customers WHERE City = 'Liverpool';



IF OBJECT_ID('dbo.DeliveredOrders', 'U') IS NOT NULL DROP TABLE dbo.DeliveredOrders;
SELECT *
INTO dbo.DeliveredOrders
FROM dbo.Orders
WHERE Status = 'Delivered';



WITH BigOrders AS (
    SELECT OrderId, CustomerId, Amount
    FROM dbo.Orders
    WHERE Amount >= 2000
)
SELECT *
FROM BigOrders;


